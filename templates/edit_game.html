{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="edit-container">
        <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–≥—Ä—ã -->
        <div class="form-section">
            <h2>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <form method="post" enctype="multipart/form-data" class="form-card">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" name="title" value="{{ game.title }}" required>

                <label>–ñ–∞–Ω—Ä:</label>
                <input type="text" name="genre" value="{{ game.genre }}" required>

                <label>–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:</label>
                <input type="number" name="year" value="{{ game.year }}" required>

                <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                <textarea name="description" rows="4" required>{{ game.description }}</textarea>

                <label>–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è (—á–∞—Å—ã):</label>
                <input type="number" name="playtime" value="{{ game.playtime if game.playtime else '' }}" min="0" step="0.5" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 8">

                {% if game.cover %}
                <label>–¢–µ–∫—É—â–∞—è –æ–±–ª–æ–∂–∫–∞:</label>
                <img src="{{ url_for('static', filename='covers/' + game.cover) }}"
                     class="current-cover">
                {% endif %}

                <label>–ù–æ–≤–∞—è –æ–±–ª–æ–∂–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <input type="file" name="cover" accept=".jpg,.png,.jpeg">

                <div class="form-actions">
                    <button class="btn" type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    <a class="btn secondary" href="{{ url_for('game', game_id=game.id) }}">
                        üîô –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–µ
                    </a>
                </div>
            </form>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —Å OST -->
        <div class="tracks-section">
            <h2>üéµ –°–∞—É–Ω–¥—Ç—Ä–µ–∫–∏</h2>

            {% if tracks %}
            <div class="tracks-list">
                {% for track in tracks %}
                <div class="track-item">
                    <div class="track-content">
                        <div class="track-icon">üéµ</div>
                        <div class="track-info">
                            <div class="track-name">{{ track.name }}</div>
                            <audio controls>
                                <source src="{{ url_for('static', filename='audio/' + track.file) }}">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
                            </audio>
                        </div>
                    </div>
                    <form method="post"
                          action="{{ url_for('delete_track', track_id=track.id, game_id=game.id) }}"
                          onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–∫?')">
                        <button class="btn danger" type="submit">
                            ‚ùå –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </form>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="no-tracks">
                <p>–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤</p>
            </div>
            {% endif %}

            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç—Ä–µ–∫–∞ -->
            <div class="add-track-form">
                <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å OST</h3>
                <form method="post"
                      action="{{ url_for('add_track', game_id=game.id) }}"
                      enctype="multipart/form-data"
                      class="form-card">
                    <div class="track-form-grid">
                        <div>
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞:</label>
                            <input type="text" name="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Main Theme" required>
                        </div>
                        <div>
                            <label>–ê—É–¥–∏–æ —Ñ–∞–π–ª (MP3):</label>
                            <input type="file" name="file" accept=".mp3" required>
                        </div>
                    </div>
                    <button class="btn wide" type="submit">
                        üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–µ–∫
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
